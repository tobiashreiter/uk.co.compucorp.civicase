<?php

/**
 * @file
 * Exported quotations saved search.
 */

$mgd = [
    [
      'name' => 'SavedSearch_Civicase_Quotations',
      'entity' => 'SavedSearch',
      'cleanup' => 'unused',
      'update' => 'unmodified',
      'params' => [
        'version' => 4,
        'values' => [
          'name' => 'Civicase_Quotations',
          'label' => 'Civicase Quotations',
          'form_values' => NULL,
          'search_custom_id' => NULL,
          'api_entity' => 'CaseSalesOrder',
          'api_params' => [
            'version' => 4,
            'select' => [
              'id',
              'client_id.display_name',
              'DATE(quotation_date) AS DATE_quotation_date',
              'description',
              'owner_id.display_name',
              'CONCAT_WS(" ", total_before_tax, currency:label) AS CONCAT_WS_total_before_tax_currency_label',
              'CONCAT_WS(" ", total_after_tax, currency:label) AS CONCAT_WS_total_after_tax_currency_label',
              'status_id:label',
              'invoicing_status_id:label',
              'payment_status_id:label',
            ],
            'orderBy' => [
              'created_at' => 'DESC',
            ],
            'where' => [],
            'groupBy' => [],
            'join' => [],
            'having' => [],
            'limit' => 10,
          ],
          'expires_date' => NULL,
          'description' => NULL,
          'mapping_id' => NULL,
        ],
      ],
    ],
    [
      'name' => 'SavedSearch_Civicase_Quotations_SearchDisplay_Civicase_Contact_Quotations_Table',
      'entity' => 'SearchDisplay',
      'cleanup' => 'unused',
      'update' => 'unmodified',
      'params' => [
        'version' => 4,
        'values' => [
          'name' => 'Civicase_Contact_Quotations_Table',
          'label' => 'Contact Quotations List',
          'saved_search_id.name' => 'Civicase_Quotations',
          'type' => 'table',
          'settings' => [
            'actions' => TRUE,
            'limit' => 10,
            'classes' => [
              'table',
              'table-striped',
            ],
            'pager' => [],
            'placeholder' => 5,
            'sort' => [
              [
                'created_at',
                'DESC',
              ],
            ],
            'columns' => [
              [
                'type' => 'field',
                'key' => 'id',
                'dataType' => 'Integer',
                'label' => 'Quote No.',
                'sortable' => TRUE,
                'alignment' => '',
              ],
              [
                'type' => 'field',
                'key' => 'DATE_quotation_date',
                'dataType' => 'Date',
                'label' => 'Date',
                'sortable' => TRUE,
                'alignment' => '',
              ],
              [
                'type' => 'field',
                'key' => 'owner_id.display_name',
                'dataType' => 'String',
                'label' => 'Owner',
                'sortable' => TRUE,
                'link' => [
                  'path' => '',
                  'entity' => 'Contact',
                  'action' => 'view',
                  'join' => 'owner_id',
                  'target' => '_blank',
                ],
                'title' => 'View Owner',
                'alignment' => '',
              ],
              [
                'type' => 'field',
                'key' => 'CONCAT_WS_total_before_tax_currency_label',
                'dataType' => 'String',
                'label' => 'Total Before Tax',
                'sortable' => TRUE,
                'alignment' => '',
              ],
              [
                'type' => 'field',
                'key' => 'CONCAT_WS_total_after_tax_currency_label',
                'dataType' => 'String',
                'label' => 'Total After Tax',
                'sortable' => TRUE,
                'alignment' => '',
              ],
              [
                'type' => 'field',
                'key' => 'invoicing_status_id:label',
                'dataType' => 'Integer',
                'label' => 'Invoicing',
                'sortable' => TRUE,
              ],
              [
                'type' => 'field',
                'key' => 'payment_status_id:label',
                'dataType' => 'Integer',
                'label' => 'Payments',
                'sortable' => TRUE,
              ],
              [
                'type' => 'field',
                'key' => 'status_id:label',
                'dataType' => 'Integer',
                'label' => 'Status',
                'sortable' => TRUE,
                'alignment' => '',
              ],
              [
                'text' => '',
                'style' => 'default',
                'size' => 'btn-sm',
                'icon' => 'fa-bars',
                'links' => [
                  [
                    'path' => '',
                    'icon' => 'fa-external-link',
                    'text' => 'View',
                    'style' => 'default',
                    'condition' => [],
                    'entity' => 'CaseSalesOrder',
                    'action' => 'view',
                    'join' => '',
                    'target' => '_blank',
                  ],
                  [
                    'entity' => 'CaseSalesOrder',
                    'action' => 'update',
                    'join' => '',
                    'target' => '_blank',
                    'icon' => 'fa-pencil',
                    'text' => 'Edit',
                    'style' => 'default',
                    'path' => '',
                    'condition' => [],
                  ],
                  [
                    'entity' => 'CaseSalesOrder',
                    'action' => 'delete',
                    'join' => '',
                    'target' => 'crm-popup',
                    'icon' => 'fa-trash',
                    'text' => 'Delete',
                    'style' => 'default',
                    'path' => '',
                    'condition' => [],
                  ],
                  [
                    'path' => 'civicrm/case-features/quotations/download-pdf?id=[id]',
                    'icon' => 'fa-file-pdf-o',
                    'text' => 'Download PDF',
                    'style' => 'default',
                    'condition' => [],
                    'entity' => '',
                    'action' => '',
                    'join' => '',
                    'target' => '_blank',
                  ],
                  [
                    'path' => 'civicrm/case-features/quotations/create-contribution?id=[id]',
                    'icon' => 'fa-credit-card',
                    'text' => 'Create Contribution',
                    'style' => 'default',
                    'condition' => [],
                    'entity' => '',
                    'action' => '',
                    'join' => '',
                    'target' => 'crm-popup',
                  ],
                  [
                    'path' => 'civicrm/case-features/quotations/email?id=[id]',
                    'icon' => 'fa-paper-plane-o',
                    'text' => 'Send By Email',
                    'style' => 'default',
                    'condition' => [],
                    'entity' => '',
                    'action' => '',
                    'join' => '',
                    'target' => 'crm-popup',
                  ],
                ],
                'type' => 'menu',
                'alignment' => '',
                'label' => 'Actions',
              ],
            ],
            'noResultsText' => 'No quotations found',
          ],
          'acl_bypass' => FALSE,
        ],
      ],
    ],
    [
      'name' => 'SavedSearch_Civicase_Quotations_SearchDisplay_Civicase_Quotations_Table',
      'entity' => 'SearchDisplay',
      'cleanup' => 'unused',
      'update' => 'unmodified',
      'params' => [
        'version' => 4,
        'values' => [
          'name' => 'Civicase_Quotations_Table',
          'label' => 'Quotations List',
          'saved_search_id.name' => 'Civicase_Quotations',
          'type' => 'table',
          'settings' => [
            'actions' => TRUE,
            'limit' => 10,
            'classes' => [
              'table',
              'table-striped',
            ],
            'pager' => [],
            'placeholder' => 5,
            'sort' => [
              [
                'created_at',
                'DESC',
              ],
            ],
            'columns' => [
              [
                'type' => 'field',
                'key' => 'id',
                'dataType' => 'Integer',
                'label' => 'Quote No.',
                'sortable' => TRUE,
                'alignment' => '',
              ],
              [
                'type' => 'field',
                'key' => 'client_id.display_name',
                'dataType' => 'String',
                'label' => 'Client',
                'sortable' => TRUE,
                'link' => [
                  'path' => '',
                  'entity' => 'Contact',
                  'action' => 'view',
                  'join' => 'client_id',
                  'target' => '_blank',
                ],
                'title' => 'View Client',
                'alignment' => '',
              ],
              [
                'type' => 'field',
                'key' => 'DATE_quotation_date',
                'dataType' => 'Date',
                'label' => 'Date',
                'sortable' => TRUE,
                'alignment' => '',
              ],
              [
                'type' => 'field',
                'key' => 'owner_id.display_name',
                'dataType' => 'String',
                'label' => 'Owner',
                'sortable' => TRUE,
                'link' => [
                  'path' => '',
                  'entity' => 'Contact',
                  'action' => 'view',
                  'join' => 'owner_id',
                  'target' => '_blank',
                ],
                'title' => 'View Owner',
                'alignment' => '',
              ],
              [
                'type' => 'field',
                'key' => 'CONCAT_WS_total_before_tax_currency_label',
                'dataType' => 'String',
                'label' => 'Total Before Tax',
                'sortable' => TRUE,
                'alignment' => '',
              ],
              [
                'type' => 'field',
                'key' => 'CONCAT_WS_total_after_tax_currency_label',
                'dataType' => 'String',
                'label' => 'Total After Tax',
                'sortable' => TRUE,
                'alignment' => '',
              ],
              [
                'type' => 'field',
                'key' => 'status_id:label',
                'dataType' => 'Integer',
                'label' => 'Status',
                'sortable' => TRUE,
                'alignment' => '',
              ],
              [
                'type' => 'field',
                'key' => 'invoicing_status_id:label',
                'dataType' => 'Integer',
                'label' => 'Invoicing',
                'sortable' => TRUE,
              ],
              [
                'type' => 'field',
                'key' => 'payment_status_id:label',
                'dataType' => 'Integer',
                'label' => 'Payments',
                'sortable' => TRUE,
              ],
              [
                'text' => '',
                'style' => 'default',
                'size' => 'btn-sm',
                'icon' => 'fa-bars',
                'links' => [
                  [
                    'path' => '',
                    'icon' => 'fa-external-link',
                    'text' => 'View',
                    'style' => 'default',
                    'condition' => [],
                    'entity' => 'CaseSalesOrder',
                    'action' => 'view',
                    'join' => '',
                    'target' => '_blank',
                  ],
                  [
                    'entity' => 'CaseSalesOrder',
                    'action' => 'update',
                    'join' => '',
                    'target' => '_blank',
                    'icon' => 'fa-pencil',
                    'text' => 'Edit',
                    'style' => 'default',
                    'path' => '',
                    'condition' => [],
                  ],
                  [
                    'entity' => 'CaseSalesOrder',
                    'action' => 'delete',
                    'join' => '',
                    'target' => 'crm-popup',
                    'icon' => 'fa-trash',
                    'text' => 'Delete',
                    'style' => 'default',
                    'path' => '',
                    'condition' => [],
                  ],
                  [
                    'path' => 'civicrm/case-features/quotations/download-pdf?id=[id]',
                    'icon' => 'fa-file-pdf-o',
                    'text' => 'Download PDF',
                    'style' => 'default',
                    'condition' => [],
                    'entity' => '',
                    'action' => '',
                    'join' => '',
                    'target' => '_blank',
                  ],
                  [
                    'path' => 'civicrm/case-features/quotations/create-contribution?id=[id]',
                    'icon' => 'fa-credit-card',
                    'text' => 'Create Contribution',
                    'style' => 'default',
                    'condition' => [],
                    'entity' => '',
                    'action' => '',
                    'join' => '',
                    'target' => 'crm-popup',
                  ],
                  [
                    'path' => 'civicrm/case-features/quotations/email?id=[id]',
                    'icon' => 'fa-paper-plane-o',
                    'text' => 'Send By Email',
                    'style' => 'default',
                    'condition' => [],
                    'entity' => '',
                    'action' => '',
                    'join' => '',
                    'target' => 'crm-popup',
                  ],
                ],
                'type' => 'menu',
                'alignment' => '',
                'label' => 'Actions',
              ],
            ],
            'noResultsText' => 'No quotations found',
          ],
          'acl_bypass' => FALSE,
        ],
      ],
    ],
    [
      'name' => 'SavedSearch_Quotation_Contributions',
      'entity' => 'SavedSearch',
      'cleanup' => 'unused',
      'update' => 'unmodified',
      'params' => [
        'version' => 4,
        'values' => [
          'name' => 'Quotation_Contributions',
          'label' => 'Quotation Contributions',
          'form_values' => NULL,
          'search_custom_id' => NULL,
          'api_entity' => 'Contribution',
          'api_params' => [
            'version' => 4,
            'select' => [
              'total_amount',
              'financial_type_id:label',
              'source',
              'receive_date',
              'thankyou_date',
              'contribution_status_id:label',
              'Opportunity_Details.Case_Opportunity',
            ],
            'orderBy' => [],
            'where' => [
              [
                'id',
                'IS NOT EMPTY',
              ],
              [
                'OR',
                [
                  [
                    'Opportunity_Details.Case_Opportunity',
                    'IS NOT EMPTY',
                  ],
                  [
                    'Opportunity_Details.Quotation',
                    'IS NOT EMPTY',
                  ],
                ],
              ],
            ],
            'groupBy' => [],
            'join' => [],
            'having' => [],
          ],
          'expires_date' => NULL,
          'description' => NULL,
          'mapping_id' => NULL,
        ],
      ],
    ],
    [
      'name' => 'SavedSearch_Quotation_Contributions_SearchDisplay_Contributions_Table_1',
      'entity' => 'SearchDisplay',
      'cleanup' => 'unused',
      'update' => 'unmodified',
      'params' => [
        'version' => 4,
        'values' => [
          'name' => 'Contributions_Table_1',
          'label' => 'Contributions Table 1',
          'saved_search_id.name' => 'Quotation_Contributions',
          'type' => 'table',
          'settings' => [
            'actions' => TRUE,
            'limit' => 10,
            'classes' => [
              'table',
              'table-striped',
            ],
            'pager' => [],
            'placeholder' => 5,
            'sort' => [],
            'columns' => [
              [
                'type' => 'field',
                'key' => 'total_amount',
                'dataType' => 'Money',
                'label' => 'Amount',
                'sortable' => TRUE,
              ],
              [
                'type' => 'field',
                'key' => 'financial_type_id:label',
                'dataType' => 'Integer',
                'label' => 'Type',
                'sortable' => TRUE,
              ],
              [
                'type' => 'field',
                'key' => 'source',
                'dataType' => 'String',
                'label' => 'Source',
                'sortable' => TRUE,
              ],
              [
                'type' => 'field',
                'key' => 'receive_date',
                'dataType' => 'Timestamp',
                'label' => 'Date',
                'sortable' => TRUE,
              ],
              [
                'type' => 'field',
                'key' => 'thankyou_date',
                'dataType' => 'Timestamp',
                'label' => 'Thank-you Sent',
                'sortable' => TRUE,
                'rewrite' => '{if "[thankyou_date]"} Yes {else} No {/if}',
              ],
              [
                'type' => 'field',
                'key' => 'contribution_status_id:label',
                'dataType' => 'Integer',
                'label' => 'Status',
                'sortable' => TRUE,
              ],
              [
                'text' => 'Actions',
                'style' => 'default',
                'size' => 'btn-sm',
                'icon' => 'fa-bars',
                'links' => [
                  [
                    'entity' => 'Contribution',
                    'action' => 'view',
                    'join' => '',
                    'target' => 'crm-popup',
                    'icon' => 'fa-external-link',
                    'text' => 'View',
                    'style' => 'default',
                    'path' => '',
                    'condition' => [],
                  ],
                  [
                    'entity' => 'Contribution',
                    'action' => 'update',
                    'join' => '',
                    'target' => 'crm-popup',
                    'icon' => 'fa-pencil',
                    'text' => 'Edit',
                    'style' => 'default',
                    'path' => '',
                    'condition' => [],
                  ],
                  [
                    'entity' => '',
                    'action' => '',
                    'join' => '',
                    'target' => 'crm-popup',
                    'icon' => 'fa-paper-plane-o',
                    'text' => 'Send By Email',
                    'style' => 'default',
                    'path' => 'civicrm/contribute/invoice/email/?reset=1&id=[id]&select=email&cid=[contact_id]',
                    'condition' => [],
                  ],
                ],
                'type' => 'menu',
                'alignment' => 'text-right',
              ],
            ],
            'noResultsText' => 'No Invoices found',
          ],
          'acl_bypass' => FALSE,
        ],
      ],
    ],
];

$searchKitIsInstalled = 'installed' ===
CRM_Extension_System::singleton()->getManager()->getStatus('org.civicrm.search_kit');
if ($searchKitIsInstalled) {
  return $mgd;
}

return [];
